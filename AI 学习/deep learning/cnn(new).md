# CNN

##  Reference

> [【综述】一文读懂卷积神经网络(CNN) - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/561991816)
>
> [原来卷积是这么计算的 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/268179286?ivk_sa=1024320u)
>
> [卷积神经网络 (CNN) 基本原理和公式_cnn公式-CSDN博客](https://blog.csdn.net/weipf8/article/details/103917202)

## 简介

### 什么是cnn

卷积神经网络是多层感知机(MLP)的变种，由生物学家休博尔和维瑟尔在早期关于猫视觉皮层的研究发展而来，视觉皮层的细胞存在一个复杂的构造，这些细胞对视觉输入空间的子区域非常敏感，称之为感受野。

如今的卷积神经网络(CNN)是一种带有卷积结构的深度神经网络，卷积结构可以减少深层网络占用的内存量，其三个关键的操作——局部感受野、权值共享、pooling层，有效地减少了网络的参数个数，缓解了模型的过拟合问题。

### 为什么需要cnn

当使用全连接神经网络处理大尺寸图像时，有三个非常明显的缺点：

- 将图像展开为向量会丢失空间信息；
- 参数过多效率低下，训练困难；
- 大量的参数也很快会导致网络过拟合。

**卷积神经网络则可以很好地解决以上三个问题。**

## 基础知识

### 卷积（*Convolution*）

> **在信号系统中就是滤波器(filter)**

![动图](.\cnn(new).assets\v2-5efbada1d4bb599e6195ce819aa7ebd9_b.webp)

**对于多通道的情况：**

输出的特征图的通道数 = 卷积核数 ， 与输入的通道数无关。

输入特征图通道数 = 每个卷积核的深度， 输入的多个通道在卷积核的每层上会加权求和（或直接求和）

![img](.\cnn(new).assets\6b85560a887d753b2affc8f38157669f.gif)



### 感受野(*Receptive Field*)

感受野指的是卷积神经网络每一层输出的特征图(feature map)上每个像素点映射回输入图像上的区域大小。神经元感受野的范围越大表示其能接触到的原始图像范围就越大，也意味着它能学习更为全局，语义层次更高的特征信息；相反，范围越小则表示其所包含的特征越趋向局部和细节。因此感受野的范围可以用来大致判断每一层的抽象层次。并且我们可以很明显地知道**网络越深，神经元的感受野越大**。

从输入特征图到输出特征图尺寸的计算公式（其中$n_{in}$为输入size，$p$为padding大小，$f$为卷积核size，$s$为卷积步长）：
$$
n_{out} = \dfrac{n_{in} + 2p - f }{s} + 1
$$
**感受野的计算公式：**
$$
RF_{l+1} + RF_{l} + (f_{l+1} - 1) \prod_{i=1}^l s_i
$$
其中$RF_{l+1}$为当前特征图对应的感受野大小，也就是我们要计算的目标感受野，$RF_l$为上一层特征图对应的感受野大小，$f_{l+1}$为当前卷积层卷积核大小，最后一项连乘项则表示之前卷积层的步长乘积。



### 权值共享





## 进阶知识







## 应用实例

### 用于图像分割的全卷积网络（FCNN）

![image-20241022203628692](G:\MyUniversity\CS-Note\AI 学习\deep learning\cnn(new).assets\image-20241022203628692.png)

<span style="text-emphasis:filled red; border:1px solid #330000;">**全卷积(FCN) = 卷积 + 反卷积**</span>



### 用于医学图像分割的 UNet

![image-20241022203832100](.\cnn(new).assets\image-20241022203832100.png)



### CNN for NLP

![image-20241022203917489](.\cnn(new).assets\image-20241022203917489.png)

<span style="border:1px solid #330000; font-size:1.1em; font-weight:bold;">cnn 用于句子情感分析</span>

